<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ecomm Website</title>
  <link rel="stylesheet" href="cart.css">
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

</head>
<body>
  
  <header>
    <div class="nav container">
    <a  href="Ecomm.html">Home</a>
    <a href="#" class="logo" style="font-weight: bold">GENTLEMAN JONES</a>
      <i class='bx bx-shopping-bag' id="cart-icon"></i>
      
      <div class="cart">
        <h2 class="cart-title">Your Cart</h2>
        <!--Content-->
        <div class="cart-content">

        </div>
        <!-- Total-->
        <div class="total">
          <div class="total-title">Total</div>
          <div class="total-price">0</div>
        </div>
        <!--Buy button-->
        <button type="button" class="btn-buy">Buy Now</button>
        <!--cart close-->
        <i class='bx bx-x' id="close-cart"></i>
      </div>
    </div>
  </header>
  <section class="shop container">
    <h2 class="section-title">Men's Wear</h2>
    <!--content-->
    <div class="shop-content">
      <!--Box 1-->
      <div class="product-box">
        <img src="pexels-bogdan-glisik-1661416.jpg" alt="" class="product-img">
        <h2 class="product-title">Men Suit</h2>
        <span class="price">12599</span>
        <i class='bx bx-shopping-bag add-cart'></i>
      </div>
      <!--Box 2-->
      <div class="product-box">
        <img src="pexels-chloe-1043474.jpg" alt="" class="product-img">
        <h2 class="product-title">Light Blue Shirt</h2>
        <span class="price">599</span>
        <i class='bx bx-shopping-bag add-cart'></i>
      </div>
      <!--Box 3-->
      <div class="product-box">
        <img src="pexels-chris-wÃ¶lfer-1561011.jpg" alt="" class="product-img">
        <h2 class="product-title">T-Shirt</h2>
        <span class="price">599</span>
        <i class='bx bx-shopping-bag add-cart'></i>
      </div>
      <!--Box 4-->
      <div class="product-box">
        <img src="pexels-hassan-ouajbir-1306248.jpg" alt="" class="product-img">
        <h2 class="product-title">Grey Pant</h2>
        <span class="price">1599</span>
        <i class='bx bx-shopping-bag add-cart'></i>
      </div>
      <!--Box 5-->
      <div class="product-box">
        <img src="pexels-jeffrey-reed-769732.jpg" alt="" class="product-img">
        <h2 class="product-title">Checks Shirt</h2>
        <span class="price">899</span>
        <i class='bx bx-shopping-bag add-cart'></i>
      </div>
      <!--Box 6-->
      <div class="product-box">
        <img src="pexels-prayoon-sajeev-2897531.jpg" alt="" class="product-img">
        <h2 class="product-title">Printed T-shirt </h2>
        <span class="price">1299</span>
        <i class='bx bx-shopping-bag add-cart'></i>
      </div>
      <!--Box 7-->
      <div class="product-box">
        <img src="pexels-sumit-kapoor-1430879.jpg" alt="" class="product-img">
        <h2 class="product-title">Black Pant</h2>
        <span class="price">1199</span>
        <i class='bx bx-shopping-bag add-cart'></i>
      </div>
      <!--Box 8-->
      <div class="product-box">
        <img src="pexels-yogendra-singh-1760900.jpg" alt="" class="product-img">
        <h2 class="product-title">Maroon Shirt</h2>
        <span class="price">1299</span>
        <i class='bx bx-shopping-bag add-cart'></i>
      </div>
    </div>
  </section>

  <script>
    //cart
    let cartIcon = document.querySelector("#cart-icon"); //selecting the first element in the document
    let cart = document.querySelector(".cart");
    let closeCart = document.querySelector("#close-cart");
    //open cart
    cartIcon.onclick = () => {
      cart.classList.add("active");
    };
    //close-cart
    closeCart.onclick = () => {
      cart.classList.remove("active");
    };

    //cart working js
    if (document.readyState == "loading") {                       // documents gets loaded
      document.addEventListener("DOMContentLoaded", ready);
    } else {
      ready();
    }



    //Making function
    function ready() {
      //remove items from cart
      var removeCartButtons = document.getElementsByClassName("cart-remove");
      console.log(removeCartButtons);
      for (var i = 0; i < removeCartButtons.length; i++) {
        var button = removeCartButtons[i];
        button.addEventListener("click", removeCartItem); // by clicking on delete the cart items gets removed
      }
      //quantity change
      var quantityInputs = document.getElementsByClassName("cart-quantity")
      for (var i = 0; i < quantityInputs.length; i++) {
        var input = quantityInputs[i];
        input.addEventListener("change", quantityChanged);
      }
      //add to cart
      var addCart = document.getElementsByClassName("add-cart")
      for (var i = 0; i < addCart.length; i++) {
        var button = addCart[i];
        button.addEventListener("click", addCartClicked);
      }
      //Buy button work
      document.getElementsByClassName('btn-buy')[0].addEventListener('click', buyButtonClicked);
    }
    //buy button
    function buyButtonClicked() {
      alert("Your Order is Placed");
      var cartContent = document.getElementsByClassName("cart-content")[0]
      while (cartContent.hasChildNodes()) {
        cartContent.removeChild(cartContent.firstChild)
      }
      updatetotal();
    }

    //remove items from cart
    function removeCartItem(event) {
      var buttonClicked = event.target
      buttonClicked.parentElement.remove();
      updatetotal();
    }
    //qty changes
    function quantityChanged(event) {
      var input = event.target
      if (isNaN(input.value) || input.value <= 0) {
        input.value = 1
      }
      updatetotal();
    }
    //add to cart
    function addCartClicked(event) {
      var button = event.target;
      var shopProducts = button.parentElement
      var title = shopProducts.getElementsByClassName("product-title")[0].innerText;
      var price = shopProducts.getElementsByClassName("price")[0].innerText;
      var productImg = shopProducts.getElementsByClassName("product-img")[0].src;
      addProductToCart(title, price, productImg);
      updatetotal();
    }
    function addProductToCart(title, price, productImg) {
      var cartShopBox = document.createElement('div');
      cartShopBox.classList.add("cart-box");
      var cartItems = document.getElementsByClassName("cart-content")[0];
      var cartItemsNames = cartItems.getElementsByClassName("cart-product-title");
      for (var i = 0; i < cartItemsNames.length; i++) {
        if (cartItemsNames[i].innerText == title) {
          alert("you already added item to cart");
          return;
        }
      }

      var cartBoxContent = `
                        <img src="${productImg}" alt="" class="cart-img">
                        <div class="detail-box">
                        <div class="cart-product-title">${title}</div>
                        <div class="cart-price">${price}</div>
                        <input type="number" value="1" class="cart-quantity">
                        </div>
                        <!--Remove cart-->
                        <i class='bx bxs-trash-alt cart-remove'></i>`;
      cartShopBox.innerHTML = cartBoxContent;
      cartItems.append(cartShopBox);
      cartShopBox.getElementsByClassName("cart-remove")[0].addEventListener("click", removeCartItem);
      cartShopBox.getElementsByClassName("cart-quantity")[0].addEventListener("change", quantityChanged);
    }


    //update ttotal
    function updatetotal() {
      var cartContent = document.getElementsByClassName("cart-content")[0];
      var cartBoxes = cartContent.getElementsByClassName("cart-box");
      var total = 0;
      for (var i = 0; i < cartBoxes.length; i++) {
        var cartBox = cartBoxes[i]; // no of items in the cart
        var priceElement = cartBox.getElementsByClassName('cart-price')[0];
        var quantityElement = cartBox.getElementsByClassName("cart-quantity")[0];
        var price = parseFloat(priceElement.innerText.replace("$", ""))
        var quantity = quantityElement.value;
        total = total + price * quantity; 
      }
      //roundoff value
      total = Math.round(total * 100) / 100;

      document.getElementsByClassName('total-price')[0].innerText = "INR " + total;
    }


  </script>



</body>

</html>